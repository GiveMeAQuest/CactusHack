<html ng-app='app'>
	<head>
		<script type='text/ng-template' id='order.html'>
				<td>
					<b ng-if='!order.completed'>{{order.id}}</b>
					<span ng-if='order.completed'>
						<font color='gray'>{{order.id}}</font>
						<i ng-if='order.completed' class='glyphicon glyphicon-ok text-success' />
					</span>
				</td>
				<td><big><font color='red'>{{order.access_token}}</font></big></td>
				<td>
					{{$parent.getTime(order.order_time)}}
				</td>
				<td>{{$parent.getTime(order.prepare_time)}}
					<span ng-if='!expired'>(через {{timeLeft}})</span>
				</td>
		</script>
		<script type='text/ng-template' id='modal.html'>
			<div class='modal-header'>
				<h4>Заказ №{{order.id}}</h4>
			</div>
			<div class='modal-body'>
				<b>Клиент: </b>{{order.user}}<br><br>
				<table class='table table-bordered table-responsive table-condensed'>
					<tr ng-repeat='product in order.products'>
						<td>{{product.info.name}}</td>
						<td>{{product.info.cost}} грн/шт.</td>
						<td>{{product.count}} шт.</td>
					</tr>
				</table>
				Всего: <b>{{order.total}} грн</b><br>
				Проверочный код: <font size=5 color='red'><b>{{order.access_token}}</b></font>
			</div>
			<div class='modal-footer'>
				<button class='btn btn-success' ng-click='mark()'>Отметить как выполненный</button>
				<button class='btn btn-primary' ng-click='close()'>ОК</button>
			</div>
		</script>
		<meta charset='utf-8' />
		<title>Happy Cake - заказы</title>
		<link rel='stylesheet' href='css/bootstrap.min.css' />
		<link rel='stylesheet' href='css/style.css' />
		<script src='js/jquery.min.js'></script>
		<script src='js/angular.min.js'></script>
		<script src='js/ui-bootstrap-tpls-1.3.2.min.js'></script>
		<script src='js/bootstrap.min.js'></script>
		<script src='js/main.js'></script>
		<script src='js/order.js'></script>
	</head>
	<body ng-controller='mainCtrl'>
		<div class='container'>
			<h1 class='text-center'>Happy Cake Online</h1>
			<div class='panel panel-default'>
				<div class='panel-heading'>
				<form class='form-inline'>
					<h3 class='text-center'>Заказы
					
						<div class='form-group'>
							<div class='btn-group'>
								<button class='btn btn-primary' ng-model='filterMode' uib-btn-radio='"all"'>Все</button>
								<button class='btn btn-primary' ng-model='filterMode' uib-btn-radio='"incomplete"'>Незавершённые</button>
								<button class='btn btn-primary' ng-model='filterMode' uib-btn-radio='"complete"'>Завершённые</button>
							</div>
						</div>
						<div class='form-group has-feedback'>
							<input type='text' ng-model='searchFilter' class='form-control input-sm' placeholder='Поиск по заказам'>
							<small class='glyphicon glyphicon-search form-control-feedback'></small>
						</div>
						<div class='form-group'>
							<span class='time'>{{curTime}}</span>
						</div>
					</form>
					</h3>
				</div>
				<table ng-if='orders.length>0' class='table table-responsive table-hover panel-body'>
					<tr>
						<th>Номер заказа</th>
						<th>Проверочный код</th>
						<th>Когда заказали</th>
						<th>Когда заберут</th>
					</tr>
					<tr order ng-repeat='order in orders | orderBy : "completed" | filter : getFilter | filter : searchFilter' data='order'  ng-class='{"success": order.completed}' />
				</table>
				<div ng-if='loading' class='panel-body'>
				<h4 class='text-center'>Загрузка...</h4>
				</div>
				<div ng-if='!loading&&orders.length==0' class='panel-body'>
					<h4 class='text-center'>Невыполненных заказов нет</h4>
				</div>
			</div>
		</div>
	</body>
</html>